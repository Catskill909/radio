generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Show {
  id               String         @id @default(uuid())
  title            String
  description      String?
  type             String
  host             String?
  email            String?
  author           String?
  explicit         Boolean        @default(false)
  category         String?
  tags             String?
  image            String?
  recordingEnabled Boolean        @default(false)
  recordingSource  String?
  language         String         @default("en-us")
  copyright        String?
  link             String?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  slots            ScheduleSlot[]
}

model ScheduleSlot {
  id          String      @id @default(uuid())
  showId      String
  startTime   DateTime
  endTime     DateTime
  sourceUrl   String?
  isRecurring Boolean     @default(false)
  recordings  Recording[]
  show        Show        @relation(fields: [showId], references: [id], onDelete: Cascade)
}

model Recording {
  id             String        @id @default(uuid())
  scheduleSlotId String?
  filePath       String
  startTime      DateTime
  endTime        DateTime?
  status         String
  createdAt      DateTime      @default(now())
  duration       Int?
  size           Int?
  episode        Episode?
  scheduleSlot   ScheduleSlot? @relation(fields: [scheduleSlotId], references: [id])
}

model Episode {
  id            String    @id @default(uuid())
  recordingId   String    @unique
  title         String
  description   String?
  publishedAt   DateTime?
  episodeNumber Int?
  seasonNumber  Int?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  duration      Int?
  host          String?
  imageUrl      String?
  tags          String?
  explicit      Boolean?
  recording     Recording @relation(fields: [recordingId], references: [id])
}

model IcecastStream {
  id           String    @id @default(uuid())
  name         String
  url          String
  isEnabled    Boolean   @default(false)
  status       String    @default("unknown")
  bitrate      Int?
  format       String?
  listeners    Int?
  maxListeners Int?
  genre        String?
  description  String?
  lastChecked  DateTime?
  errorMessage String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model StationSettings {
  id        String   @id @default("station")
  timezone  String   @default("UTC")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
